[
    {
        "create": "audit_event",
        "autoIndexId": true,
        "validator": {
            "$jsonSchema": {
                "bsonType": "object",
                "title": "audit_event",
                "description": "The audit event schema",
                "required": ["execution_time"],
                "properties": {
                    "application": {
                        "bsonType": "string",
                        "description": "The name of the application that generated the audit event"
                    },
                    "service": {
                        "bsonType": "string",
                        "description": "The name of the service that generated the audit event"
                    },
                    "event": {
                        "bsonType": "string",
                        "description": "The name of the event that occurred"
                    },
                    "execution_time": {
                        "bsonType": "date",
                        "description": "The timestamp of the event"
                    },
                    "response_time": {
                        "bsonType": "long",
                        "description": "The response time of the event in nanoseconds"
                    },
                    "status": {
                        "bsonType": "int",
                        "minimum": 0,
                        "maximum": 2,
                        "exclusiveMaximum": false,
                        "description": "The status of the event"
                    },
                    "user_agent": {
                        "bsonType": "string",
                        "description": "The user agent of the event"
                    },
                    "user": {
                        "bsonType": "object",
                        "properties": {
                            "username": {
                                "bsonType": "string",
                                "description": "The username of the user that generated the event"
                            },
                            "name": {
                                "bsonType": "string",
                                "description": "The name of the user that generated the event"
                            },
                            "document": {
                                "bsonType": "object",
                                "properties": {
                                    "number": {
                                        "bsonType": "string",
                                        "description": "The document number of the user"
                                    },
                                    "type": {
                                        "bsonType": "string",
                                        "description": "The document type of the user"
                                    }
                                }
                            },
                            "internal_id": {
                                "bsonType": "string",
                                "description": "The internal ID of the user"
                            }
                        }
                    },
                    "tracing": {
                        "bsonType": "object",
                        "properties": {
                            "trace_id": {
                                "bsonType": "string",
                                "description": "The trace ID of the event"
                            },
                            "span_id": {
                                "bsonType": "string",
                                "description": "The span ID of the event"
                            }
                        }
                    },
                    "details": {
                        "bsonType": "array",
                        "description": "The details of the event",
                        "items": {
                            "bsonType": "object",
                            "required": ["key", "display_name"],
                            "properties": {
                                "key": {
                                    "bsonType": "string",
                                    "description": "The key of the detail"
                                },
                                "val": {
                                    "bsonType": "string",
                                    "description": "The value of the detail"
                                },
                                "display_name": {
                                    "bsonType": "string",
                                    "description": "The display name of the detail"
                                }
                            }
                        }
                    },
                    "response_body": {
                        "bsonType": "string",
                        "description": "The response body of the audit event"
                    },
                    "response_processed": {
                        "bsonType": "bool",
                        "description": "Whether the response body has been processed"
                    },
                    "bearer_token": {
                        "bsonType": "string",
                        "description": "The bearer token used to authenticate the request"
                    }
                }
            }
        }
    }
]